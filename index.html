<!DOCTYPE html>
<html>
<head>
  <title>Simplified Survey</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }
    .form-container {
      border: 1px solid #ddd;
      padding: 20px;
      border-radius: 5px;
    }
    .result {
      margin-top: 20px;
      padding: 10px;
      border-radius: 5px;
    }
    .success {
      background-color: #d4edda;
      color: #155724;
    }
    .error {
      background-color: #f8d7da;
      color: #721c24;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h1>Simplified Survey</h1>
    
    <form id="simpleForm">
      <div>
        <label for="imageId">Image ID:</label>
        <input type="text" id="imageId" name="imageId" value="image1" required>
      </div>
      
      <div style="margin-top: 20px;">
        <button type="button" id="submitBtn">Submit</button>
      </div>
    </form>
    
    <div id="result" class="result" style="display: none;"></div>
  </div>
  
  <script>
    // Replace with your Apps Script URL
    const scriptURL = "https://script.google.com/macros/s/AKfycbxey8k8rpQxOtrV-TN-CknQP5L8Oj6u-JrcFN3DDMLrfbWvEeGvlnsqy1NebIXeGBm4_A/exec";
    
    // Elements
    const form = document.getElementById("simpleForm");
    const submitBtn = document.getElementById("submitBtn");
    const resultDiv = document.getElementById("result");
    
    // Submit using a simple JSONP approach
    submitBtn.addEventListener("click", function() {
      // Get the image ID
      const imageId = document.getElementById("imageId").value;
      
      if (!imageId) {
        showResult("Please enter an Image ID", "error");
        return;
      }
      
      // Disable button during submission
      submitBtn.disabled = true;
      
      // Create a unique callback name
      const callbackName = 'jsonpCallback_' + Math.round(100000 * Math.random());
      
      // Set up the callback function
      window[callbackName] = function(response) {
        submitBtn.disabled = false;
        
        if (response && response.result === "success") {
          showResult("Submission successful!", "success");
        } else {
          showResult("Error: " + (response?.error || "Unknown error"), "error");
        }
        
        // Clean up
        document.body.removeChild(script);
        delete window[callbackName];
      };
      
      // Build URL with parameters
      const url = `${scriptURL}?callback=${callbackName}&imageId=${encodeURIComponent(imageId)}`;
      
      // Create script element
      const script = document.createElement('script');
      script.src = url;
      
      // Handle errors
      script.onerror = function() {
        submitBtn.disabled = false;
        showResult("Network error. Please try again.", "error");
        document.body.removeChild(script);
        delete window[callbackName];
      };
      
      // Add timeout
      setTimeout(function() {
        if (window[callbackName]) {
          submitBtn.disabled = false;
          showResult("Request timed out. Please try again.", "error");
          
          if (script.parentNode) {
            document.body.removeChild(script);
          }
          delete window[callbackName];
        }
      }, 10000);
      
      // Start request
      document.body.appendChild(script);
    });
    
    // Helper function to show results
    function showResult(message, type) {
      resultDiv.textContent = message;
      resultDiv.className = "result " + type;
      resultDiv.style.display = "block";
    }
  </script>
</body>
</html>